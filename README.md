# VoiceSearch (文本到语音提示词搜索工具)

这是一个基于 Web 的交互式工具，用于搜索和优化 Qwen3-TTS-Voice-Design 的声音提示词 (Voice Prompts)。通过“生成-试听-反馈”的迭代循环，帮助用户快速找到理想的声音风格。

## 核心功能

*   **迭代式搜索**: 从模糊描述开始，通过每一轮的反馈（评分、选优、备注），引导 AI 生成更符合需求的声音描述。
*   **多维度控制**: 自动探索音色、情绪、语速、口音等维度。
*   **即时试听**: 集成 Qwen3-TTS 模型，实时合成音频。
*   **去重机制**: 智能检测重复的提示词，保持探索的多样性。
*   **完全本地化**: 会话数据本地存储，支持导出 JSON。

## 安装与运行

### 1. 环境准备

确保安装了 Python 3.9+。

```bash
git clone <repository_url>
cd voicesearch
pip install -r requirements.txt
```

### 2. 配置 Token

本项目依赖：
1. **Hugging Face Token**: 用于 Qwen2.5-72B-Instruct (LLM) 推理。
2. **DashScope API Key**: 用于 Qwen3-TTS-Voice-Design (TTS) 生成。

请确保设置以下环境变量：

```bash
# Hugging Face Token (https://huggingface.co/settings/tokens)
export HF_TOKEN=hf_...

# DashScope API Key (https://dashscope.console.aliyun.com/)
export DASHSCOPE_API_KEY=sk-.....
```

**本地文件支持**
* HF Token: 也会读取 `~/.huggingface/token`
* DashScope: 仅支持环境变量 `DASHSCOPE_API_KEY` 或 `API_KEY`

### 3. 启动服务

```bash
cd voicesearch
uvicorn app:app --reload --port 8000
```

服务启动后，访问浏览器: `http://localhost:8000`

## 使用指南

1.  **开始会话**: 在首页设置语言（中文/英文）、测试文本（预览音色用的句子）以及每轮生成的候选数量。
2.  **听取与反馈**: 系统会生成一组声音候选。点击播放试听。
3.  **迭代**:
    *   为你喜欢的候选打高分。
    *   **必须**选中一个 "Best"（最佳）候选作为下一轮的基准。
    *   (可选) 在底部输入框填写具体建议（如“更年轻一点”、“语速慢一些”）。
    *   点击 "Generate Next Iteration"。
4.  **导出**: 随时点击侧边栏的 "Export Session JSON" 保存当前的探索记录。

## 目录结构

*   `core/`: 核心逻辑 (LLM, TTS, 存储, 去重)
*   `web/`: 前端资源 (HTML, CSS, JS)
*   `data/`: 生成的音频和会话数据

## 注意事项

*   本工具调用远程 Alibaba Cloud DashScope API (Qwen Voice Design)，生成速度取决于网络状况。
*   请勿生成违规或侵犯版权的声音内容。

---
Generated by Gemini CLI
